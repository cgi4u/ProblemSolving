처음부터 해법은 떠올렸으나, 초기화 문제 때문에 시간을 허비했다.

다른 것들은 1을 스킵하게 해놓고,
for (int i = 0; i < n; i++) {
	before[i] = cur[i];
	before_count[i] = cur_count[i];
}
라는 작업은 1에서도 실행하게 해서, cur_count[0]을 초기화 안하니까 문제가 생겼다.
코딩 스타일의 비일관성 때문이라고 할 수도 있을 것 같다.
이렇게 할 바에야 그냥 1에서 해야 할 작업은 다 밖으로 빼고 2부터 시작하거나, 
1인지 확인하는 문 else에 1일 때의 작업을 모두 놓는 게 일관성 면에서 문제가 없다.
일단은 초기화할때 방어적으로 할수 있는 건 다 하는 습관을 들여야할 것 같다.